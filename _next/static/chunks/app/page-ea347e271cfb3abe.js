(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2791:(e,r,t)=>{Promise.resolve().then(t.bind(t,2212))},2212:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>p});var a=t(7437),l=t(2265),s=t(7719),i=t.n(s);i().accessToken="pk.eyJ1IjoiZG9jamJhaWxleTE5NzEiLCJhIjoiY21ld3lzZTNqMGQwdzJxb2lwNHpjcjNveiJ9.T2O5szdwL-O5nDF9BJmFnw";let o=[],n={Agronomy:{color:"#ffd700",outline:"#a67c00"},"Grain/Feed":{color:"#ff7f0e",outline:"#a64e00"},"Office/Service":{color:"#1f78ff",outline:"#0d3d99"}};function c(e){let{selectedCategories:r,selectedStates:t}=e,s=(0,l.useRef)(null),c=(0,l.useRef)(null),d=(0,l.useRef)(null);return(0,l.useEffect)(()=>{c.current||(c.current=new(i()).Map({container:s.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-93.5,41.7],zoom:4.2,projection:{name:"mercator"}}),c.current.addControl(new(i()).NavigationControl,"top-right"),c.current.on("load",async()=>{try{let e=await fetch("".concat("/certis_agroute_app","/retailers.geojson"));if(!e.ok)throw Error("Failed to fetch GeoJSON: ".concat(e.status));let r=await e.json();if(!r||!r.features){console.warn("⚠️ No valid features found in retailers.geojson");return}let t={...r,features:r.features.map(e=>{var r;let t=(null===(r=e.properties)||void 0===r?void 0:r.category)||"",a="Other";return"Kingpin"===t?a="Kingpin":"Agronomy"===t||"Agronomy/Grain"===t?a="Agronomy":["Grain","Feed","Grain/Feed"].includes(t)?a="Grain/Feed":"Office/Service"===t&&(a="Office/Service"),{...e,properties:{...e.properties,groupedCategory:a}}})},a=new Set;t.features.forEach(e=>{var r;(null===(r=e.properties)||void 0===r?void 0:r.state)&&a.add(e.properties.state)}),o=Array.from(a).sort(),console.log("\uD83D\uDCCD Available states:",o),c.current.getSource("retailers")&&(c.current.getLayer("retailer-points")&&c.current.removeLayer("retailer-points"),c.current.getLayer("kingpins")&&c.current.removeLayer("kingpins"),c.current.removeSource("retailers")),c.current.addSource("retailers",{type:"geojson",data:t});let l=["match",["get","groupedCategory"]],s=["match",["get","groupedCategory"]];for(let[e,r]of Object.entries(n))l.push(e,r.color),s.push(e,r.outline);l.push("#cccccc"),s.push("#000000"),c.current.addLayer({id:"retailer-points",type:"circle",source:"retailers",filter:["all",["!=",["get","groupedCategory"],"Kingpin"]],paint:{"circle-radius":5,"circle-color":l,"circle-stroke-color":s,"circle-stroke-width":1}}),c.current.addLayer({id:"kingpins",type:"circle",source:"retailers",filter:["==",["get","groupedCategory"],"Kingpin"],paint:{"circle-radius":6,"circle-color":"#ff0000","circle-stroke-color":"#ffff00","circle-stroke-width":2}}),c.current.on("mouseenter","retailer-points",e=>{var r,t;c.current.getCanvas().style.cursor="pointer";let a=(null===(r=e.features)||void 0===r?void 0:r[0].geometry).coordinates.slice(),l=null===(t=e.features)||void 0===t?void 0:t[0].properties;l&&(d.current&&d.current.remove(),d.current=new(i()).Popup({closeButton:!1,closeOnClick:!1}).setLngLat(a).setHTML('\n              <div style="font-weight:bold; margin-bottom:4px;">'.concat(l.name||"","</div>\n              <div>").concat(l.address||"","</div>\n              <div>").concat(l.city||"",", ").concat(l.state||""," ").concat(l.zip||"","</div>\n              <div><b>Category:</b> ").concat(l.groupedCategory||"N/A","</div>\n              <div><b>Retailer:</b> ").concat(l.retailer||"N/A","</div>\n              <div><b>Suppliers:</b> ").concat(l.suppliers||"N/A","</div>\n            ")).addTo(c.current))}),c.current.on("mouseleave","retailer-points",()=>{c.current.getCanvas().style.cursor="",d.current&&(d.current.remove(),d.current=null)})}catch(e){console.error("❌ Error loading geojson:",e)}}))},[]),(0,l.useEffect)(()=>{if(!c.current||!c.current.getLayer("retailer-points"))return;let e=!(r.length>0)||["in",["get","groupedCategory"],["literal",r]],a=!(t.length>0)||["in",["get","state"],["literal",t]];c.current.setFilter("retailer-points",["all",["!=",["get","groupedCategory"],"Kingpin"],e,a])},[r,t]),(0,a.jsx)("div",{ref:s,className:"w-full h-full"})}var d=t(6648);let g=["IA","IL","IN","MI","MN","ND","NE","OH","SD","WI"],u={Agronomy:{color:"#ffd700",outline:"#a67c00"},"Grain/Feed":{color:"#ff7f0e",outline:"#a64e00"},"Office/Service":{color:"#1f78ff",outline:"#0d3d99"},Kingpin:{color:"#ff0000",outline:"#ffff00"}};function p(){let[e,r]=(0,l.useState)([]),[t,s]=(0,l.useState)([]),i=e=>{r(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])},o=e=>{s(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])};return(0,a.jsxs)("div",{className:"flex h-screen w-screen",children:[(0,a.jsxs)("aside",{className:"w-80 bg-gray-100 dark:bg-gray-900 p-4 border-r border-gray-300 dark:border-gray-700 overflow-y-auto",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,a.jsx)(d.default,{src:"".concat("/certis_agroute_app","/certis-logo.png"),alt:"Certis Logo",width:180,height:60,priority:!0})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Home Zip Code"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter ZIP",className:"w-full p-2 rounded border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"State Filter"}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-3",children:[(0,a.jsx)("button",{onClick:()=>{s([...g])},className:"px-2 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>{s([])},className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:g.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-1",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.includes(e),onChange:()=>o(e),className:"mr-1"}),(0,a.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:e})]},e))})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Retailer Filter"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Filter by retailer name"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Categories"}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,a.jsx)("button",{onClick:()=>{r(Object.keys(u).filter(e=>"Kingpin"!==e))},className:"px-2 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>{r([])},className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})]}),(0,a.jsx)("ul",{className:"space-y-2",children:Object.entries(u).map(r=>{let[t,l]=r;return(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"filter-".concat(t),checked:e.includes(t),onChange:()=>i(t),className:"mr-2",disabled:"Kingpin"===t}),(0,a.jsxs)("label",{htmlFor:"filter-".concat(t),className:"flex items-center text-gray-700 dark:text-gray-300",children:[(0,a.jsx)("span",{className:"inline-block w-4 h-4 mr-2 rounded-full border",style:{backgroundColor:l.color,borderColor:l.outline||"#000"}}),t]})]},t)})}),(0,a.jsx)("p",{className:"mt-3 text-sm text-red-600 dark:text-yellow-400 font-semibold",children:"Kingpins are always visible (bright red, yellow border)."})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Supplier Filter"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Filter by supplier"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Debug Info"}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Selected States:"})," ",t.length>0?t.join(", "):"None"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Selected Categories:"})," ",e.length>0?e.join(", "):"None"]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Trip Optimization"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Collect points and optimize route"})]})]}),(0,a.jsx)("main",{className:"flex-1 relative",children:(0,a.jsx)(c,{selectedCategories:e,selectedStates:t})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[415,648,130,215,744],()=>r(2791)),_N_E=e.O()}]);