(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2791:(e,t,r)=>{Promise.resolve().then(r.bind(r,2212))},2212:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(7437),s=r(2265),l=r(7719),n=r.n(l);n().accessToken="pk.eyJ1IjoiZG9jamJhaWxleTE5NzEiLCJhIjoiY21ld3lzZTNqMGQwdzJxb2lwNHpjcjNveiJ9.T2O5szdwL-O5nDF9BJmFnw";let i={Agronomy:{color:"#ffd700",outline:"#a67c00"},"Grain/Feed":{color:"#98ff98",outline:"#228b22"},"Office/Service":{color:"#1f78ff",outline:"#0d3d99"}};function o(e){let{selectedCategories:t,selectedStates:r,selectedSuppliers:l,selectedRetailers:o,onStatesLoaded:c,onRetailersLoaded:d}=e,g=(0,s.useRef)(null),u=(0,s.useRef)(null),x=(0,s.useRef)(null);return(0,s.useEffect)(()=>{u.current||(u.current=new(n()).Map({container:g.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-93.5,41.7],zoom:4.2,projection:{name:"mercator"}}),u.current.addControl(new(n()).NavigationControl,"top-right"),u.current.on("load",async()=>{try{let r=await fetch("".concat("/certis_agroute_app","/retailers.geojson"));if(!r.ok)throw Error("Failed to fetch GeoJSON: ".concat(r.status));let a=await r.json();if(!a||!a.features){console.warn("⚠️ No valid features found in retailers.geojson");return}let s={...a,features:a.features.map(e=>{var t;let r=(null===(t=e.properties)||void 0===t?void 0:t.category)||"",a="Other";return"Kingpin"===r?a="Kingpin":"Agronomy"===r||"Agronomy/Grain"===r?a="Agronomy":["Grain","Feed","Grain/Feed"].includes(r)?a="Grain/Feed":"Office/Service"===r&&(a="Office/Service"),{...e,properties:{...e.properties,groupedCategory:a}}})},l=new Set,o=new Set;s.features.forEach(e=>{var t,r;(null===(t=e.properties)||void 0===t?void 0:t.state)&&l.add(e.properties.state),(null===(r=e.properties)||void 0===r?void 0:r.retailer)&&o.add(e.properties.retailer)}),c&&c(Array.from(l).sort()),d&&d(Array.from(o).sort()),u.current.getSource("retailers")&&(u.current.getLayer("retailer-points")&&u.current.removeLayer("retailer-points"),u.current.getLayer("kingpins")&&u.current.removeLayer("kingpins"),u.current.removeSource("retailers")),u.current.addSource("retailers",{type:"geojson",data:s});let g=["match",["get","groupedCategory"]],p=["match",["get","groupedCategory"]];for(let[e,t]of Object.entries(i))g.push(e,t.color),p.push(e,t.outline);function e(e){var t,r;let a=(null===(t=e.features)||void 0===t?void 0:t[0].geometry).coordinates.slice(),s=null===(r=e.features)||void 0===r?void 0:r[0].properties;s&&(x.current||(x.current=new(n()).Popup({closeButton:!1,closeOnClick:!1,offset:10})),x.current.setLngLat(a).setHTML('\n              <div style="font-weight:bold; font-size:14px; margin-bottom:4px;">\n                '.concat(s.retailer||"",'\n              </div>\n              <div style="font-style:italic; font-size:14px; margin-bottom:4px;">\n                ').concat(s.name||"",'\n              </div>\n              <div style="font-size:14px; margin-bottom:4px;">\n                ').concat(s.address||"",'\n              </div>\n              <div style="font-size:14px; margin-bottom:4px;">\n                ').concat(s.city||"",", ").concat(s.state||""," ").concat(s.zip||"",'\n              </div>\n              <div style="font-size:14px;">\n                <b>Category:</b> ').concat(s.groupedCategory||"N/A",'\n              </div>\n              <div style="font-size:14px;">\n                <b>Suppliers:</b> ').concat(s.suppliers||"N/A","\n              </div>\n            ")).addTo(u.current))}function t(){x.current&&(x.current.remove(),x.current=null)}g.push("#cccccc"),p.push("#000000"),u.current.addLayer({id:"retailer-points",type:"circle",source:"retailers",filter:["==",["get","groupedCategory"],""],paint:{"circle-radius":5,"circle-color":g,"circle-stroke-color":p,"circle-stroke-width":1}}),u.current.addLayer({id:"kingpins",type:"circle",source:"retailers",filter:["==",["get","groupedCategory"],"Kingpin"],paint:{"circle-radius":6,"circle-color":"#ff0000","circle-stroke-color":"#ffff00","circle-stroke-width":2}}),u.current.on("mousemove","retailer-points",e),u.current.on("mouseleave","retailer-points",t),u.current.on("mousemove","kingpins",e),u.current.on("mouseleave","kingpins",t)}catch(e){console.error("❌ Error loading geojson:",e)}}))},[]),(0,s.useEffect)(()=>{if(!u.current||!u.current.getLayer("retailer-points"))return;if(0===r.length||0===t.length){u.current.setFilter("retailer-points",["==",["get","groupedCategory"],""]);return}let e=!(t.length>0)||["in",["get","groupedCategory"],["literal",t]],a=!(r.length>0)||["in",["get","state"],["literal",r]],s=!(l.length>0)||["in",["get","suppliers"],["literal",l]],n=!(o.length>0)||["in",["get","retailer"],["literal",o]];u.current.setFilter("retailer-points",["all",["!=",["get","groupedCategory"],"Kingpin"],e,a,s,n])},[t,r,l,o]),(0,a.jsx)("div",{ref:g,className:"w-full h-full"})}var c=r(6648),d=r(4697),g=r(2873);let u=["Certis Biologicals","BASF","Bayer","Corteva","Syngenta"];function x(){let[e,t]=(0,s.useState)([]),[r,l]=(0,s.useState)([]),[n,x]=(0,s.useState)([]),[p,m]=(0,s.useState)([]),[h,y]=(0,s.useState)([]),[b,f]=(0,s.useState)([]),[j,v]=(0,s.useState)(!1),N=e=>{x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},k=e=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},w=e=>{y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},C=e=>{f(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,a.jsxs)("div",{className:"flex h-screen w-screen relative",children:[(0,a.jsx)("button",{className:"absolute top-3 left-3 z-20 p-2 bg-gray-800 text-white rounded-md md:hidden",onClick:()=>v(!j),"aria-label":"Toggle sidebar",children:j?(0,a.jsx)(d.Z,{size:20}):(0,a.jsx)(g.Z,{size:20})}),(0,a.jsxs)("aside",{className:"fixed md:static top-0 left-0 h-full w-72 bg-gray-100 dark:bg-gray-900 p-4 border-r border-gray-300 dark:border-gray-700 overflow-y-auto z-10 transform transition-transform duration-300\n        ".concat(j?"translate-x-0":"-translate-x-full"," md:translate-x-0"),children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,a.jsx)(c.default,{src:"".concat("/certis_agroute_app","/certis-logo.png"),alt:"Certis Logo",width:180,height:60,priority:!0})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Home Zip Code"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter ZIP",className:"w-full p-2 rounded border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"State Filter"}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-3",children:[(0,a.jsx)("button",{onClick:()=>{m([...e])},className:"px-2 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>{m([])},className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:e.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-1",children:[(0,a.jsx)("input",{type:"checkbox",checked:p.includes(e),onChange:()=>k(e),className:"mr-1"}),(0,a.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:e})]},e))})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Retailer Filter"}),(0,a.jsx)("div",{className:"flex space-x-2 mb-3",children:(0,a.jsx)("button",{onClick:()=>{f([])},className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})}),(0,a.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:r.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:b.includes(e),onChange:()=>C(e)}),(0,a.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:e})]},e))})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Categories"}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,a.jsx)("button",{onClick:()=>{x(Object.keys(i).filter(e=>"Kingpin"!==e))},className:"px-2 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>{x([])},className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})]}),(0,a.jsx)("ul",{className:"space-y-2",children:Object.entries(i).map(e=>{let[t,r]=e;return(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"filter-".concat(t),checked:n.includes(t),onChange:()=>N(t),className:"mr-2",disabled:"Kingpin"===t}),(0,a.jsxs)("label",{htmlFor:"filter-".concat(t),className:"flex items-center text-gray-700 dark:text-gray-300",children:[(0,a.jsx)("span",{className:"inline-block w-4 h-4 mr-2 rounded-full border",style:{backgroundColor:r.color,borderColor:r.outline||"#000"}}),t]})]},t)})}),(0,a.jsx)("p",{className:"mt-3 text-sm text-red-600 dark:text-yellow-400 font-semibold",children:"Kingpins are always visible (bright red, yellow border)."})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Supplier Filter"}),(0,a.jsx)("div",{className:"flex space-x-2 mb-3",children:(0,a.jsx)("button",{onClick:()=>{y([])},className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})}),(0,a.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:u.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:h.includes(e),onChange:()=>w(e)}),(0,a.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:e})]},e))})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Debug Info"}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Selected States:"})," ",p.length>0?p.join(", "):"None"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Selected Retailers:"})," ",b.length>0?b.join(", "):"None"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Selected Categories:"})," ",n.length>0?n.join(", "):"None"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Selected Suppliers:"})," ",h.length>0?h.join(", "):"None"]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Trip Optimization"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Collect points and optimize route"})]})]}),(0,a.jsx)("main",{className:"flex-1 relative",children:(0,a.jsx)(o,{selectedCategories:n,selectedStates:p,selectedSuppliers:h,selectedRetailers:b,onStatesLoaded:t,onRetailersLoaded:l})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[415,758,130,215,744],()=>t(2791)),_N_E=e.O()}]);