(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2791:(e,r,t)=>{Promise.resolve().then(t.bind(t,2212))},2212:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var a=t(7437),s=t(2265),l=t(7719),n=t.n(l);n().accessToken="pk.eyJ1IjoiZG9jamJhaWxleTE5NzEiLCJhIjoiY21ld3lzZTNqMGQwdzJxb2lwNHpjcjNveiJ9.T2O5szdwL-O5nDF9BJmFnw";let i=[],o={Agronomy:{color:"#ffd700",outline:"#a67c00"},"Grain/Feed":{color:"#98ff98",outline:"#228b22"},"Office/Service":{color:"#1f78ff",outline:"#0d3d99"}};function c(e){let{selectedCategories:r,selectedStates:t}=e,l=(0,s.useRef)(null),c=(0,s.useRef)(null),d=(0,s.useRef)(null);return(0,s.useEffect)(()=>{c.current||(c.current=new(n()).Map({container:l.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-93.5,41.7],zoom:4.2,projection:{name:"mercator"}}),c.current.addControl(new(n()).NavigationControl,"top-right"),c.current.on("load",async()=>{try{let t=await fetch("".concat("/certis_agroute_app","/retailers.geojson"));if(!t.ok)throw Error("Failed to fetch GeoJSON: ".concat(t.status));let a=await t.json();if(!a||!a.features){console.warn("⚠️ No valid features found in retailers.geojson");return}let s={...a,features:a.features.map(e=>{var r;let t=(null===(r=e.properties)||void 0===r?void 0:r.category)||"",a="Other";return"Kingpin"===t?a="Kingpin":"Agronomy"===t||"Agronomy/Grain"===t?a="Agronomy":["Grain","Feed","Grain/Feed"].includes(t)?a="Grain/Feed":"Office/Service"===t&&(a="Office/Service"),{...e,properties:{...e.properties,groupedCategory:a}}})},l=new Set;s.features.forEach(e=>{var r;(null===(r=e.properties)||void 0===r?void 0:r.state)&&l.add(e.properties.state)}),i=Array.from(l).sort(),console.log("\uD83D\uDCCD Available states:",i),c.current.getSource("retailers")&&(c.current.getLayer("retailer-points")&&c.current.removeLayer("retailer-points"),c.current.getLayer("kingpins")&&c.current.removeLayer("kingpins"),c.current.removeSource("retailers")),c.current.addSource("retailers",{type:"geojson",data:s});let g=["match",["get","groupedCategory"]],u=["match",["get","groupedCategory"]];for(let[e,r]of Object.entries(o))g.push(e,r.color),u.push(e,r.outline);function e(e){var r,t;let a=(null===(r=e.features)||void 0===r?void 0:r[0].geometry).coordinates.slice(),s=null===(t=e.features)||void 0===t?void 0:t[0].properties;s&&(d.current||(d.current=new(n()).Popup({closeButton:!1,closeOnClick:!1,offset:10})),d.current.setLngLat(a).setHTML('\n              <div style="font-weight:bold; font-size:14px; margin-bottom:4px;">\n                '.concat(s.retailer||"",'\n              </div>\n              <div style="font-style:italic; font-size:14px; margin-bottom:4px;">\n                ').concat(s.name||"",'\n              </div>\n              <div style="font-size:14px; margin-bottom:4px;">\n                ').concat(s.address||"",'\n              </div>\n              <div style="font-size:14px; margin-bottom:4px;">\n                ').concat(s.city||"",", ").concat(s.state||""," ").concat(s.zip||"",'\n              </div>\n              <div style="font-size:14px;">\n                <b>Category:</b> ').concat(s.groupedCategory||"N/A",'\n              </div>\n              <div style="font-size:14px;">\n                <b>Suppliers:</b> ').concat(s.suppliers||"N/A","\n              </div>\n            ")).addTo(c.current))}function r(){d.current&&(d.current.remove(),d.current=null)}g.push("#cccccc"),u.push("#000000"),c.current.addLayer({id:"retailer-points",type:"circle",source:"retailers",filter:["==",["get","groupedCategory"],""],paint:{"circle-radius":5,"circle-color":g,"circle-stroke-color":u,"circle-stroke-width":1}}),c.current.addLayer({id:"kingpins",type:"circle",source:"retailers",filter:["==",["get","groupedCategory"],"Kingpin"],paint:{"circle-radius":6,"circle-color":"#ff0000","circle-stroke-color":"#ffff00","circle-stroke-width":2}}),c.current.on("mousemove","retailer-points",e),c.current.on("mouseleave","retailer-points",r),c.current.on("mousemove","kingpins",e),c.current.on("mouseleave","kingpins",r)}catch(e){console.error("❌ Error loading geojson:",e)}}))},[]),(0,s.useEffect)(()=>{if(!c.current||!c.current.getLayer("retailer-points"))return;if(0===t.length||0===r.length){c.current.setFilter("retailer-points",["==",["get","groupedCategory"],""]);return}let e=!(r.length>0)||["in",["get","groupedCategory"],["literal",r]],a=!(t.length>0)||["in",["get","state"],["literal",t]];c.current.setFilter("retailer-points",["all",["!=",["get","groupedCategory"],"Kingpin"],e,a])},[r,t]),(0,a.jsx)("div",{ref:l,className:"w-full h-full"})}var d=t(6648);let g=["IA","IL","IN","MI","MN","ND","NE","OH","SD","WI"];function u(){let[e,r]=(0,s.useState)([]),[t,l]=(0,s.useState)([]),n=e=>{r(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])},i=e=>{l(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])};return(0,a.jsxs)("div",{className:"flex h-screen w-screen",children:[(0,a.jsxs)("aside",{className:"w-80 bg-gray-100 dark:bg-gray-900 p-4 border-r border-gray-300 dark:border-gray-700 overflow-y-auto",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,a.jsx)(d.default,{src:"".concat("/certis_agroute_app","/certis-logo.png"),alt:"Certis Logo",width:180,height:60,priority:!0})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Home Zip Code"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter ZIP",className:"w-full p-2 rounded border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"State Filter"}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-3",children:[(0,a.jsx)("button",{onClick:()=>{l([...g])},className:"px-2 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>{l([])},className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:g.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-1",children:[(0,a.jsx)("input",{type:"checkbox",checked:t.includes(e),onChange:()=>i(e),className:"mr-1"}),(0,a.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:e})]},e))})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Retailer Filter"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Filter by retailer name"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Categories"}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,a.jsx)("button",{onClick:()=>{r(Object.keys(o).filter(e=>"Kingpin"!==e))},className:"px-2 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>{r([])},className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})]}),(0,a.jsx)("ul",{className:"space-y-2",children:Object.entries(o).map(r=>{let[t,s]=r;return(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"filter-".concat(t),checked:e.includes(t),onChange:()=>n(t),className:"mr-2",disabled:"Kingpin"===t}),(0,a.jsxs)("label",{htmlFor:"filter-".concat(t),className:"flex items-center text-gray-700 dark:text-gray-300",children:[(0,a.jsx)("span",{className:"inline-block w-4 h-4 mr-2 rounded-full border",style:{backgroundColor:s.color,borderColor:s.outline||"#000"}}),t]})]},t)})}),(0,a.jsx)("p",{className:"mt-3 text-sm text-red-600 dark:text-yellow-400 font-semibold",children:"Kingpins are always visible (bright red, yellow border)."})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Supplier Filter"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Filter by supplier"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Debug Info"}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Selected States:"})," ",t.length>0?t.join(", "):"None"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Selected Categories:"})," ",e.length>0?e.join(", "):"None"]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Trip Optimization"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Collect points and optimize route"})]})]}),(0,a.jsx)("main",{className:"flex-1 relative",children:(0,a.jsx)(c,{selectedCategories:e,selectedStates:t})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[415,648,130,215,744],()=>r(2791)),_N_E=e.O()}]);