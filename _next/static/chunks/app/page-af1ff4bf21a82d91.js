(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2791:(e,r,t)=>{Promise.resolve().then(t.bind(t,2212))},2212:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>p});var s=t(7437),a=t(2265),l=t(7719),n=t.n(l);n().accessToken="pk.eyJ1IjoiZG9jamJhaWxleTE5NzEiLCJhIjoiY21ld3lzZTNqMGQwdzJxb2lwNHpjcjNveiJ9.T2O5szdwL-O5nDF9BJmFnw";let i=[],o=[],c=[],d={Agronomy:{color:"#ffd700",outline:"#a67c00"},"Grain/Feed":{color:"#98ff98",outline:"#228b22"},"Office/Service":{color:"#1f78ff",outline:"#0d3d99"}};function g(e){let{selectedCategories:r,selectedStates:t,selectedSuppliers:l,selectedRetailers:g}=e,u=(0,a.useRef)(null),p=(0,a.useRef)(null),x=(0,a.useRef)(null);return(0,a.useEffect)(()=>{p.current||(p.current=new(n()).Map({container:u.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-93.5,41.7],zoom:4.2,projection:{name:"mercator"}}),p.current.addControl(new(n()).NavigationControl,"top-right"),p.current.on("load",async()=>{try{let t=await fetch("".concat("/certis_agroute_app","/retailers.geojson"));if(!t.ok)throw Error("Failed to fetch GeoJSON: ".concat(t.status));let s=await t.json();if(!s||!s.features){console.warn("⚠️ No valid features found in retailers.geojson");return}let a={...s,features:s.features.map(e=>{var r;let t=(null===(r=e.properties)||void 0===r?void 0:r.category)||"",s="Other";return"Kingpin"===t?s="Kingpin":"Agronomy"===t||"Agronomy/Grain"===t?s="Agronomy":["Grain","Feed","Grain/Feed"].includes(t)?s="Grain/Feed":"Office/Service"===t&&(s="Office/Service"),{...e,properties:{...e.properties,groupedCategory:s}}})},l=new Set,g=new Set,u=new Set;a.features.forEach(e=>{var r,t,s;(null===(r=e.properties)||void 0===r?void 0:r.state)&&l.add(e.properties.state),(null===(t=e.properties)||void 0===t?void 0:t.suppliers)&&e.properties.suppliers.split(",").forEach(e=>g.add(e.trim())),(null===(s=e.properties)||void 0===s?void 0:s.retailer)&&u.add(e.properties.retailer)}),i=Array.from(l).sort(),o=Array.from(g).sort(),c=Array.from(u).sort(),console.log("\uD83D\uDCCD Available states:",i),console.log("\uD83C\uDFED Available suppliers:",o),console.log("\uD83C\uDFEA Available retailers:",c),p.current.getSource("retailers")&&(p.current.getLayer("retailer-points")&&p.current.removeLayer("retailer-points"),p.current.getLayer("kingpins")&&p.current.removeLayer("kingpins"),p.current.removeSource("retailers")),p.current.addSource("retailers",{type:"geojson",data:a});let h=["match",["get","groupedCategory"]],m=["match",["get","groupedCategory"]];for(let[e,r]of Object.entries(d))h.push(e,r.color),m.push(e,r.outline);function e(e){var r,t;let s=(null===(r=e.features)||void 0===r?void 0:r[0].geometry).coordinates.slice(),a=null===(t=e.features)||void 0===t?void 0:t[0].properties;a&&(x.current||(x.current=new(n()).Popup({closeButton:!1,closeOnClick:!1,offset:10})),x.current.setLngLat(s).setHTML('\n              <div style="font-weight:bold; font-size:14px; margin-bottom:4px;">\n                '.concat(a.retailer||"",'\n              </div>\n              <div style="font-style:italic; font-size:14px; margin-bottom:4px;">\n                ').concat(a.name||"",'\n              </div>\n              <div style="font-size:14px; margin-bottom:4px;">\n                ').concat(a.address||"",'\n              </div>\n              <div style="font-size:14px; margin-bottom:4px;">\n                ').concat(a.city||"",", ").concat(a.state||""," ").concat(a.zip||"",'\n              </div>\n              <div style="font-size:14px;">\n                <b>Category:</b> ').concat(a.groupedCategory||"N/A",'\n              </div>\n              <div style="font-size:14px;">\n                <b>Suppliers:</b> ').concat(a.suppliers||"N/A","\n              </div>\n            ")).addTo(p.current))}function r(){x.current&&(x.current.remove(),x.current=null)}h.push("#cccccc"),m.push("#000000"),p.current.addLayer({id:"retailer-points",type:"circle",source:"retailers",filter:["==",["get","groupedCategory"],""],paint:{"circle-radius":5,"circle-color":h,"circle-stroke-color":m,"circle-stroke-width":1}}),p.current.addLayer({id:"kingpins",type:"circle",source:"retailers",filter:["==",["get","groupedCategory"],"Kingpin"],paint:{"circle-radius":6,"circle-color":"#ff0000","circle-stroke-color":"#ffff00","circle-stroke-width":2}}),p.current.on("mousemove","retailer-points",e),p.current.on("mouseleave","retailer-points",r),p.current.on("mousemove","kingpins",e),p.current.on("mouseleave","kingpins",r)}catch(e){console.error("❌ Error loading geojson:",e)}}))},[]),(0,a.useEffect)(()=>{if(!p.current||!p.current.getLayer("retailer-points"))return;if(0===t.length||0===r.length){p.current.setFilter("retailer-points",["==",["get","groupedCategory"],""]);return}let e=!(r.length>0)||["in",["get","groupedCategory"],["literal",r]],s=!(t.length>0)||["in",["get","state"],["literal",t]],a=!(l.length>0)||["in",["get","suppliers"],["literal",l]],n=!(g.length>0)||["in",["get","retailer"],["literal",g]];p.current.setFilter("retailer-points",["all",["!=",["get","groupedCategory"],"Kingpin"],e,s,a,n])},[r,t,l,g]),(0,s.jsx)("div",{ref:u,className:"w-full h-full"})}var u=t(6648);function p(){let[e,r]=(0,a.useState)([]),[t,l]=(0,a.useState)([]),[n,p]=(0,a.useState)([]),[x,h]=(0,a.useState)([]),m=(e,r,t)=>{r(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},y=e=>e([]),f=(e,r)=>r([...e]);return(0,s.jsxs)("div",{className:"flex h-screen w-screen",children:[(0,s.jsxs)("aside",{className:"w-80 bg-gray-100 dark:bg-gray-900 p-4 border-r border-gray-300 dark:border-gray-700 overflow-y-auto",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,s.jsx)(u.default,{src:"".concat("/certis_agroute_app","/certis-logo.png"),alt:"Certis Logo",width:180,height:60,priority:!0})}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"State Filter"}),(0,s.jsxs)("div",{className:"flex space-x-2 mb-3",children:[(0,s.jsx)("button",{onClick:()=>f(i,l),className:"px-2 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Select All"}),(0,s.jsx)("button",{onClick:()=>y(l),className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})]}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2",children:i.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-1",children:[(0,s.jsx)("input",{type:"checkbox",checked:t.includes(e),onChange:()=>m(t,l,e)}),(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:e})]},e))})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Categories"}),(0,s.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,s.jsx)("button",{onClick:()=>r(Object.keys(d).filter(e=>"Kingpin"!==e)),className:"px-2 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Select All"}),(0,s.jsx)("button",{onClick:()=>y(r),className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Clear All"})]}),(0,s.jsx)("ul",{className:"space-y-2",children:Object.entries(d).map(t=>{let[a,l]=t;return(0,s.jsxs)("li",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:e.includes(a),onChange:()=>m(e,r,a),disabled:"Kingpin"===a}),(0,s.jsxs)("label",{className:"flex items-center text-gray-700 dark:text-gray-300",children:[(0,s.jsx)("span",{className:"inline-block w-4 h-4 mr-2 rounded-full border",style:{backgroundColor:l.color,borderColor:l.outline}}),a]})]},a)})})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Suppliers"}),(0,s.jsx)("button",{onClick:()=>y(p),className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700 mb-3",children:"Clear All"}),(0,s.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:o.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:n.includes(e),onChange:()=>m(n,p,e)}),(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:e})]},e))})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Retailers"}),(0,s.jsx)("button",{onClick:()=>y(h),className:"px-2 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700 mb-3",children:"Clear All"}),(0,s.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:c.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:x.includes(e),onChange:()=>m(x,h,e)}),(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:e})]},e))})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:"Debug Info"}),(0,s.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"States:"})," ",t.join(", ")||"None"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Categories:"})," ",e.join(", ")||"None"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Suppliers:"})," ",n.join(", ")||"None"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Retailers:"})," ",x.join(", ")||"None"]})]})]})]}),(0,s.jsx)("main",{className:"flex-1 relative",children:(0,s.jsx)(g,{selectedCategories:e,selectedStates:t,selectedSuppliers:n,selectedRetailers:x})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[415,648,130,215,744],()=>r(2791)),_N_E=e.O()}]);