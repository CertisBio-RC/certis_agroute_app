(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22],{2158:(e,t,s)=>{Promise.resolve().then(s.bind(s,4271))},4271:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(5155),l=s(2115),r=s(8999),n=s(5255);function o(e){if(!e)return null;try{let t=JSON.parse(e);if(!t||"object"!=typeof t)return null;return t}catch(e){return null}}function i(e){let t=Number(e||0)/1609.344;return isFinite(t)?t<.1?"<0.1 mi":t<10?"".concat(t.toFixed(1)," mi"):"".concat(t.toFixed(0)," mi"):"—"}function d(e){let t=Number(e||0)/60;if(!isFinite(t))return"—";if(t<1)return"<1 min";if(t<60)return"".concat(Math.round(t)," min");let s=Math.floor(t/60),a=Math.round(t-60*s);return"".concat(s,"h ").concat(a,"m")}function c(e){for(let t of e){let e=o(sessionStorage.getItem(t));if(e)return e;let s=o(localStorage.getItem(t));if(s)return s}return null}function m(){var e,t,s,o;let m=(0,r.useSearchParams)(),p=(0,l.useMemo)(()=>((null==m?void 0:m.get("pid"))||"").trim(),[m]),[x,u]=(0,l.useState)(null),[h,b]=(0,l.useState)("");(0,l.useEffect)(()=>{try{let e=function(e){let t=c(function(e){let t=[];for(let s of(t.push((0,n.Zc)(e)),t.push(n.AQ),n.Jk))t.push((0,n.kR)(s,e)),t.push(s);return Array.from(new Set(t.filter(Boolean)))}(e));return t||c(Array.from(new Set([n.AQ,...n.Jk])))}(p);u(e)}catch(e){u(null)}try{let e=function(){for(let e of[n.OF,...n.Bi]){let t=sessionStorage.getItem(e)||localStorage.getItem(e);if(t)return t}return""}();b(e||"")}catch(e){b("")}},[p]);let N=(null==x?void 0:x.pid)?"Trip Print — ".concat(x.pid):"Trip Print",f=(null==x?void 0:x.generatedAt)?String(x.generatedAt):"",v=Array.isArray(null==x?void 0:x.stops)&&((null==x?void 0:null===(e=x.stops)||void 0===e?void 0:e.length)||0)>0,j=Array.isArray(null==x?void 0:x.legs)?x.legs:[],y=null!==(o=null==x?void 0:x.totals)&&void 0!==o?o:null;return(0,a.jsx)("main",{className:"min-h-screen bg-white text-black",children:(0,a.jsxs)("div",{className:"mx-auto max-w-5xl px-6 py-8",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-extrabold tracking-tight",children:N}),f?(0,a.jsxs)("div",{className:"mt-1 text-sm text-black/70",children:["Generated: ",f]}):null,(null==x?void 0:x.pid)?(0,a.jsxs)("div",{className:"mt-1 text-xs text-black/60",children:["pid: ",x.pid]}):null]}),(0,a.jsxs)("div",{className:"flex gap-2 print:hidden",children:[(0,a.jsx)("button",{type:"button",onClick:()=>window.print(),className:"rounded-lg border border-black/20 bg-black px-4 py-2 text-sm font-bold text-white hover:bg-black/90",children:"Print / Save PDF"}),(0,a.jsx)("button",{type:"button",onClick:()=>window.close(),className:"rounded-lg border border-black/20 bg-white px-4 py-2 text-sm font-bold text-black hover:bg-black/5",title:"Closes this tab (if opened by the app)",children:"Close Tab"})]})]}),(0,a.jsx)("hr",{className:"my-6 border-black/15"}),x?v?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("section",{className:"rounded-xl border border-black/15 p-4",children:[(0,a.jsx)("div",{className:"text-lg font-extrabold",children:"Home"}),(0,a.jsxs)("div",{className:"mt-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold",children:"Label:"})," ",(null==x?void 0:null===(t=x.home)||void 0===t?void 0:t.label)||"—"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold",children:"ZIP:"})," ",(null==x?void 0:null===(s=x.home)||void 0===s?void 0:s.zip)||"—"]})]})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-black/15 p-4",children:[(0,a.jsx)("div",{className:"text-lg font-extrabold",children:"Stops"}),(0,a.jsx)("div",{className:"mt-3 space-y-3",children:((null==x?void 0:x.stops)||[]).map((e,t)=>{let s=String((null==e?void 0:e.label)||(null==e?void 0:e.name)||(null==e?void 0:e.id)||"Stop ".concat(t+1)),l=String((null==e?void 0:e.retailer)||""),r=[null==e?void 0:e.address,null==e?void 0:e.city,null==e?void 0:e.state,null==e?void 0:e.zip].filter(Boolean).join(", ");return(0,a.jsx)("div",{className:"rounded-lg border border-black/10 p-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("div",{className:"text-sm font-extrabold",children:[t+1,". ",s]}),l?(0,a.jsx)("div",{className:"mt-1 text-xs text-black/70",children:l}):null,r?(0,a.jsx)("div",{className:"mt-1 text-xs text-black/70",children:r}):null]}),(null==e?void 0:e.kind)?(0,a.jsx)("div",{className:"shrink-0 rounded-md border border-black/10 px-2 py-1 text-[11px] font-bold",children:String(e.kind)}):null]})},"".concat(t,"-").concat(s))})})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-black/15 p-4",children:[(0,a.jsx)("div",{className:"text-lg font-extrabold",children:"Route Totals"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-black/80",children:y?(0,a.jsxs)("div",{className:"rounded-lg border border-black/10 p-3",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-bold",children:"Total distance:"})," ",i(null==y?void 0:y.distanceMeters)]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-bold",children:"Total drive time:"})," ",d(null==y?void 0:y.durationSeconds)]})]}):(0,a.jsx)("div",{className:"text-sm text-black/70",children:"No totals were included in the payload."})})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-black/15 p-4",children:[(0,a.jsx)("div",{className:"text-lg font-extrabold",children:"Stops & Distances"}),j&&0!==j.length?(0,a.jsx)("div",{className:"mt-3 overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full border-collapse text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-black/20 text-left",children:[(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold",children:"Leg"}),(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold",children:"From"}),(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold",children:"To"}),(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold whitespace-nowrap",children:"Distance"}),(0,a.jsx)("th",{className:"py-2 pr-0 font-extrabold whitespace-nowrap",children:"Drive Time"})]})}),(0,a.jsx)("tbody",{children:j.map((e,t)=>(0,a.jsxs)("tr",{className:"border-b border-black/10 align-top",children:[(0,a.jsx)("td",{className:"py-2 pr-3 font-bold",children:t+1}),(0,a.jsx)("td",{className:"py-2 pr-3",children:String((null==e?void 0:e.fromLabel)||"—")}),(0,a.jsx)("td",{className:"py-2 pr-3",children:String((null==e?void 0:e.toLabel)||"—")}),(0,a.jsx)("td",{className:"py-2 pr-3 whitespace-nowrap",children:i(null==e?void 0:e.distanceMeters)}),(0,a.jsx)("td",{className:"py-2 pr-0 whitespace-nowrap",children:d(null==e?void 0:e.durationSeconds)})]},"leg-".concat(t)))})]})}):(0,a.jsx)("div",{className:"mt-2 text-sm text-black/70",children:"No route legs were included in the payload."})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-black/15 p-4",children:[(0,a.jsx)("div",{className:"text-lg font-extrabold",children:"Channel Summary — Trip"}),Array.isArray(null==x?void 0:x.channelSummary)&&x.channelSummary.length>0?(0,a.jsxs)("div",{className:"mt-3 overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full border-collapse text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-black/20 text-left",children:[(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold",children:"Retailer"}),(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold whitespace-nowrap",children:"Trip Stops"}),(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold whitespace-nowrap",children:"Total Locations"}),(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold whitespace-nowrap",children:"Agronomy"}),(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold",children:"Suppliers"}),(0,a.jsx)("th",{className:"py-2 pr-3 font-extrabold",children:"Categories"}),(0,a.jsx)("th",{className:"py-2 pr-0 font-extrabold whitespace-nowrap",children:"States"})]})}),(0,a.jsx)("tbody",{children:((null==x?void 0:x.channelSummary)||[]).map((e,t)=>{let s=Array.isArray(null==e?void 0:e.suppliers)?e.suppliers.join(", "):"",l=Array.isArray(null==e?void 0:e.categoryBreakdown)?e.categoryBreakdown.join(", "):"",r=Array.isArray(null==e?void 0:e.states)?e.states.join(", "):"";return(0,a.jsxs)("tr",{className:"border-b border-black/10 align-top",children:[(0,a.jsx)("td",{className:"py-2 pr-3 font-bold",children:String((null==e?void 0:e.retailer)||"—")}),(0,a.jsx)("td",{className:"py-2 pr-3",children:Number((null==e?void 0:e.tripStops)||0)}),(0,a.jsx)("td",{className:"py-2 pr-3",children:Number((null==e?void 0:e.totalLocations)||0)}),(0,a.jsx)("td",{className:"py-2 pr-3",children:Number((null==e?void 0:e.agronomyLocations)||0)}),(0,a.jsx)("td",{className:"py-2 pr-3",children:s||"—"}),(0,a.jsx)("td",{className:"py-2 pr-3",children:l||"—"}),(0,a.jsx)("td",{className:"py-2 pr-0",children:r||"—"})]},"cs-".concat(t))})})]}),(0,a.jsx)("div",{className:"mt-2 text-xs text-black/60",children:"Note: Supplier/Category/States are listed as provided by the payload."})]}):(0,a.jsx)("div",{className:"mt-2 text-sm text-black/70",children:"No channel summary rows were included in the payload."})]})]}):(0,a.jsxs)("div",{className:"rounded-xl border border-black/15 p-4",children:[(0,a.jsx)("div",{className:"text-base font-bold",children:"Payload found, but no stops were included."}),(0,a.jsx)("div",{className:"mt-2 text-sm text-black/70",children:"Add at least one stop in the main app, then click Print again."})]}):(0,a.jsxs)("div",{className:"rounded-xl border border-black/15 p-4",children:[(0,a.jsx)("div",{className:"text-base font-bold",children:"No print payload found."}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-black/70",children:["Go back to the main app tab and click ",(0,a.jsx)("span",{className:"font-semibold",children:"Print / Save as PDF"})," again."]})]})]})})}function p(){return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)("main",{className:"min-h-screen bg-white text-black",children:(0,a.jsx)("div",{className:"mx-auto max-w-5xl px-6 py-10",children:(0,a.jsxs)("div",{className:"rounded-xl border border-black/15 p-4",children:[(0,a.jsx)("div",{className:"text-base font-bold",children:"Loading print view…"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-black/70",children:"Preparing your trip payload."})]})})}),children:(0,a.jsx)(m,{})})}},5255:(e,t,s)=>{"use strict";s.d(t,{AQ:()=>r,Ay:()=>p,Bi:()=>i,Jk:()=>o,OF:()=>n,Zc:()=>d,kR:()=>c});var a=s(5155),l=s(2115);let r="certis_trip_print_payload_v2",n="certis_app_state_v1",o=["cad_trip_print_payload_v2"],i=["cad_app_state_v1"];function d(e){return c(r,e)}function c(e,t){let s=String(t||"").trim().replace(/[^a-zA-Z0-9_-]/g,"").slice(0,64);return s?"".concat(e,"__").concat(s):e}function m(e){return String(null!=e?e:"").trim()}function p(e){let t=e.tripStops.length>=1,s=(0,l.useMemo)(()=>d(e.pid||""),[e.pid]),n=(0,l.useMemo)(()=>{let t=e.tripStops.map((e,t)=>({idx:t+1,id:m(e.id),label:m(e.label),retailer:m(e.retailer),name:m(e.name),address:m(e.address),city:m(e.city),state:m(e.state),zip:m(e.zip),kind:m(e.kind),email:m(e.email),phoneOffice:m(e.phoneOffice),phoneCell:m(e.phoneCell)})),s=(e.routeLegs||[]).map(e=>({fromLabel:m(e.fromLabel),toLabel:m(e.toLabel),distanceMeters:Number(e.distanceMeters||0),durationSeconds:Number(e.durationSeconds||0)})),a=e.routeTotals?{distanceMeters:Number(e.routeTotals.distanceMeters||0),durationSeconds:Number(e.routeTotals.durationSeconds||0)}:null,l=(e.channelSummaryRows||[]).map(e=>({retailer:m(e.retailer),tripStops:Number(e.tripStops||0),totalLocations:Number(e.totalLocations||0),agronomyLocations:Number(e.agronomyLocations||0),suppliers:Array.isArray(e.suppliers)?e.suppliers.map(m).filter(Boolean):[],categoryBreakdown:Array.isArray(e.categoryBreakdown)?e.categoryBreakdown.map(m).filter(Boolean):[],states:Array.isArray(e.states)?e.states.map(m).filter(Boolean):[]}));return{v:2,pid:m(e.pid||""),generatedAt:m(e.generatedAt),basePath:m(e.basePath),home:{label:m(e.homeLabel),zip:m(e.homeZip),coords:e.homeCoords?[Number(e.homeCoords[0]),Number(e.homeCoords[1])]:null},stops:t,legs:s,totals:a,channelSummary:l}},[e.generatedAt,e.basePath,e.pid,e.homeLabel,e.homeZip,e.homeCoords,e.tripStops,e.routeLegs,e.routeTotals,e.channelSummaryRows]);return(0,a.jsxs)("div",{className:"rounded-xl border ring-1 backdrop-blur-sm p-3 bg-[linear-gradient(180deg,rgba(59,130,246,0.14),rgba(8,20,45,0.12))] border-[color:rgba(165,243,252,0.16)] ring-[color:rgba(147,197,253,0.10)] shadow-[0_14px_30px_rgba(0,0,0,0.45)]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("div",{className:"text-sm font-extrabold leading-tight text-yellow-300",children:"Print Trip (PDF)"}),(0,a.jsx)("div",{className:"text-[11px] text-white/60 whitespace-nowrap",children:t?"Ready":"Add ≥ 1 stop"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{if(!t)return;try{let t=JSON.stringify(n);for(let a of(localStorage.setItem(s,t),sessionStorage.setItem(s,t),localStorage.setItem(r,t),sessionStorage.setItem(r,t),o)){let s=c(a,e.pid||"");localStorage.setItem(s,t),sessionStorage.setItem(s,t),localStorage.setItem(a,t),sessionStorage.setItem(a,t)}}catch(e){}let a="".concat(e.basePath,"/print").concat(e.pid?"?pid=".concat(encodeURIComponent(e.pid)):"");window.open(a,"_blank","noopener,noreferrer")||window.location.assign(a)},disabled:!t,className:["mt-2 w-full rounded-xl px-4 py-2 text-sm font-extrabold",t?"bg-[#fde047] text-black hover:bg-[#fde047]/90":"bg-white/10 text-white/40 cursor-not-allowed"].join(" "),children:"Print / Save as PDF"}),(0,a.jsxs)("div",{className:"mt-2 text-[12px] text-white/70 leading-snug",children:["Opens an ink-safe print view in a ",(0,a.jsx)("span",{className:"font-semibold text-white/90",children:"new tab"}),". Your trip stays loaded here."]}),e.routeTotals&&(0,a.jsxs)("div",{className:"mt-2 text-[11px] text-white/60",children:["Route total:"," ",(0,a.jsxs)("span",{className:"text-white/80 font-semibold",children:[function(e){let t=e/1609.344;return isFinite(t)?t<.1?"<0.1 mi":t<10?"".concat(t.toFixed(1)," mi"):"".concat(t.toFixed(0)," mi"):"—"}(e.routeTotals.distanceMeters)," • ",function(e){let t=e/60;if(!isFinite(t))return"—";if(t<1)return"<1 min";if(t<60)return"".concat(Math.round(t)," min");let s=Math.floor(t/60),a=Math.round(t-60*s);return"".concat(s,"h ").concat(a,"m")}(e.routeTotals.durationSeconds)]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(2158)),_N_E=e.O()}]);