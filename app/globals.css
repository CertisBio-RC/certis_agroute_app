@tailwind base;
@tailwind components;
@tailwind utilities;

/* ==========================================================================
   GLOBALS
   - Keep global styling minimal.
   - Page-level theme (blue glass gradients) is controlled in app/page.tsx.
   ========================================================================== */

html,
body {
  height: 100%;
}

body {
  margin: 0;
  /* IMPORTANT: do NOT set an app-wide gradient background here.
     The UI theme is defined in page.tsx (appBg). */
  background: transparent;
}

/* ==========================================================================
   LAYOUT SAFETY
   - These help prevent "0-height children" issues in flex/grid stacks.
   ========================================================================== */

#_next {
  min-height: 100%;
}

/* ==========================================================================
   MAP CONTAINER + MAPBOX CANVAS SAFETY
   Goal: prevent the "blank map on mobile" problem caused by 0-height canvases.
   ========================================================================== */

/* The map panel in page.tsx uses the 'map-container' class on the <main> wrapper */
.map-container {
  width: 100%;
  height: 100%;
  /* On mobile/tablet, we explicitly guarantee vertical space for the map panel.
     (Your JSX also has a min-height, this reinforces it at the CSS layer.) */
  min-height: 56vh;
  overflow: hidden;
}

/* Once we hit desktop grid, the panel is full-height of its grid cell */
@media (min-width: 1024px) {
  .map-container {
    min-height: 0;
    height: 100%;
  }
}

/* Force Mapbox internals to fill the container */
.map-container canvas,
.map-container .mapboxgl-canvas,
.map-container .mapboxgl-canvas-container,
.map-container .mapboxgl-map {
  width: 100% !important;
  height: 100% !important;
}

/* Ensure the canvas can receive pointer events */
.map-container canvas {
  display: block;
  pointer-events: auto;
  touch-action: pan-x pan-y;
}

/* ==========================================================================
   MAPBOX POPUP — POPUP THEME + WIDTH SAFETY
   Fixes:
   - Popup content width behaving oddly across screen sizes
   - Add-to-Trip button should be full width
   - Close "X" MUST stay top-right and remain bold/thick (not stretched)
   ========================================================================== */

/* Cap popup size to a reasonable max, but allow it to shrink on small screens */
.mapboxgl-popup {
  max-width: min(420px, 92vw);
}

/* Popup content container */
.mapboxgl-popup-content {
  position: relative;

  background: #1e1e1e;
  color: rgba(255, 255, 255, 0.92);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 14px;
  box-shadow: 0 18px 50px rgba(0, 0, 0, 0.55);

  padding: 12px 12px 10px 12px;

  /* Width behavior */
  width: auto;
  max-width: 100%;
  box-sizing: border-box;
}

/* Keep inner elements from overflowing the popup */
.mapboxgl-popup-content * {
  max-width: 100%;
  box-sizing: border-box;
}

/* Full-width ONLY for real content controls — NOT the Mapbox close button */
.mapboxgl-popup-content button:not(.mapboxgl-popup-close-button),
.mapboxgl-popup-content a,
.mapboxgl-popup-content select,
.mapboxgl-popup-content input {
  width: 100%;
  max-width: 100%;
}

/* Headings / body text */
.mapboxgl-popup-content h3 {
  margin: 0 0 6px 0;
  font-size: 14px;
  font-weight: 800;
  letter-spacing: 0.02em;
  color: rgba(253, 224, 71, 0.95);
}

.mapboxgl-popup-content p {
  margin: 0;
  font-size: 12px;
  line-height: 1.25rem;
  color: rgba(255, 255, 255, 0.86);
}

/* Strong close button (top-right, bold, no stretching) */
.mapboxgl-popup-close-button {
  position: absolute;
  top: 8px;
  right: 10px;

  width: auto !important;
  height: auto !important;

  padding: 4px 8px;
  line-height: 1;
  font-size: 22px;
  font-weight: 900;

  background: transparent;
  border: 0;
  color: rgba(255, 255, 255, 0.85);
  border-radius: 10px;
}

.mapboxgl-popup-close-button:hover {
  background: rgba(250, 204, 21, 0.18);
  color: rgba(255, 255, 255, 0.95);
}

/* ==========================================================================
   NOTE:
   If you have custom marker CSS (home/kingpin icons) elsewhere, keep it there.
   globals.css should not control app-wide color themes.
   ========================================================================== */
