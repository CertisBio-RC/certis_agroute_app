@tailwind base;
@tailwind components;
@tailwind utilities;

/* ==========================================================================
   GLOBALS
   - Keep global styling minimal.
   - Page-level theme (blue glass gradients) is controlled in app/page.tsx.
   ========================================================================== */

html,
body {
  height: 100%;
}

body {
  margin: 0;
  /* IMPORTANT: do NOT set an app-wide gradient background here.
     The UI theme is defined in page.tsx (appBg). */
  background: transparent;
}

/* ==========================================================================
   LAYOUT SAFETY
   - These help prevent "0-height children" issues in flex/grid stacks.
   ========================================================================== */

#_next {
  min-height: 100%;
}

/* ==========================================================================
   MAP CONTAINER + MAPBOX CANVAS SAFETY
   Goal: prevent the "blank map on mobile" problem caused by 0-height canvases.
   ========================================================================== */

/* The map panel in page.tsx uses the 'map-container' class on the <main> wrapper */
.map-container {
  width: 100%;
  height: 100%;
  /* On mobile/tablet, we explicitly guarantee vertical space for the map panel.
     (Your JSX also has min-h/viewport heights; this reinforces it at the CSS layer.) */
  min-height: 56vh;
  overflow: hidden;
}

/* Once we hit desktop grid, the panel is full-height of its grid cell */
@media (min-width: 1024px) {
  .map-container {
    min-height: 0;
    height: 100%;
  }
}

/* Force Mapbox internals to fill the container */
.map-container canvas,
.map-container .mapboxgl-canvas,
.map-container .mapboxgl-canvas-container,
.map-container .mapboxgl-map {
  width: 100% !important;
  height: 100% !important;
}

/* Ensure the canvas can receive pointer events */
.map-container canvas {
  display: block;
  pointer-events: auto;
  touch-action: pan-x pan-y;
}

/* ==========================================================================
   MAPBOX POPUP — POPUP THEME + WIDTH CLAMPING (FIXES “YELLOW BAR ESCAPES CARD”)
   ========================================================================== */

/* Remove Mapbox’s default max-width behavior on the outer wrapper */
.mapboxgl-popup {
  max-width: none !important;
}

/* Hard-clamp the popup card itself */
.mapboxgl-popup-content {
  box-sizing: border-box;
  background: #1e1e1e;
  color: rgba(255, 255, 255, 0.92);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 14px;
  box-shadow: 0 18px 50px rgba(0, 0, 0, 0.55);

  /* THE IMPORTANT PART */
  width: 320px; /* desktop target */
  max-width: calc(100vw - 36px); /* mobile safety */
  overflow: hidden; /* prevents any child from “bleeding” outside the card */

  padding: 12px 12px 10px 12px;
}

/* Force everything inside to respect the card width */
.mapboxgl-popup-content *,
.mapboxgl-popup-content *::before,
.mapboxgl-popup-content *::after {
  box-sizing: border-box;
  max-width: 100%;
}

/* Buttons/inputs/selects inside popups must never exceed the card width */
.mapboxgl-popup-content button,
.mapboxgl-popup-content a,
.mapboxgl-popup-content input,
.mapboxgl-popup-content select,
.mapboxgl-popup-content textarea {
  max-width: 100%;
}

/* If your “Add to Trip” is a block/button, this ensures it fits perfectly */
.mapboxgl-popup-content button,
.mapboxgl-popup-content a {
  width: 100%;
}

/* Typical text styling */
.mapboxgl-popup-content h3 {
  margin: 0 0 6px 0;
  font-size: 14px;
  font-weight: 800;
  letter-spacing: 0.02em;
  color: rgba(253, 224, 71, 0.95);
}

.mapboxgl-popup-content p {
  margin: 0;
  font-size: 12px;
  line-height: 1.25rem;
  color: rgba(255, 255, 255, 0.86);
}

/* Close button */
.mapboxgl-popup-close-button {
  color: rgba(255, 255, 255, 0.75);
  font-size: 18px;
  padding: 4px 8px;
  border-radius: 10px;
}

.mapboxgl-popup-close-button:hover {
  background: rgba(250, 204, 21, 0.18);
  color: rgba(255, 255, 255, 0.92);
}

/* ==========================================================================
   NOTE:
   If you have custom marker CSS (home/kingpin icons) elsewhere, keep it there.
   globals.css should not control app-wide color themes.
   ========================================================================== */
